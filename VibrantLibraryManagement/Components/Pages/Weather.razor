@page "/weather"

@using Microsoft.AspNetCore.Authentication
@using Microsoft.AspNetCore.Authentication.Google
@inject NavigationManager Navigation
@inject IAuthenticationService AuthenticationService
@inject ILogger<Login> Logger
@inject IHttpContextAccessor HttpContextAccessor

<PageTitle>Login</PageTitle>

<h3>Login with Google</h3>

<button class="btn btn-primary" @onclick="SignInWithGoogle">Sign in with Google</button>

@code {
    private async Task SignInWithGoogle()
    {
        try
        {
            // Get the current HttpContext and call the ChallengeAsync method with the required parameters.
            var authenticationProperties = new AuthenticationProperties { RedirectUri = "/" };
            await AuthenticationService.ChallengeAsync(HttpContextAccessor.HttpContext, GoogleDefaults.AuthenticationScheme, authenticationProperties);
        }
        catch (Exception ex)
        {
            Logger.LogError("Error during Google login: {Message}", ex.Message);
        }
    }
}

